{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "task.frontmatter.schema.json",
  "title": "Task Frontmatter Schema",
  "description": "Schema for task file YAML frontmatter in .tasks/<id>.md",
  "type": "object",
  "required": [
    "id",
    "title",
    "kind",
    "risk",
    "state",
    "created_at",
    "updated_at",
    "intent_hash_algo",
    "intent_hash_scope"
  ],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^[a-z0-9][a-z0-9-]*[a-z0-9]$|^[a-z0-9]$",
      "description": "Unique task identifier (kebab-case, alphanumeric with hyphens)"
    },
    "title": {
      "type": "string",
      "minLength": 1,
      "maxLength": 120,
      "description": "Human-readable task title"
    },
    "kind": {
      "type": "string",
      "enum": ["feature", "fix", "refactor", "docs", "chore", "spike"],
      "description": "Task category"
    },
    "risk": {
      "type": "string",
      "enum": ["low", "medium", "high"],
      "description": "Risk assessment for the task"
    },
    "state": {
      "type": "string",
      "enum": ["draft", "open", "closed", "invalid"],
      "description": "Current task state"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "RFC3339 UTC timestamp of task creation"
    },
    "updated_at": {
      "type": "string",
      "format": "date-time",
      "description": "RFC3339 UTC timestamp of last update"
    },
    "intent_hash_algo": {
      "type": "string",
      "const": "sha256-v1",
      "description": "Hash algorithm identifier"
    },
    "intent_hash_scope": {
      "type": "string",
      "const": "canonical-intent",
      "description": "Scope of content included in hash"
    },
    "intent_hash": {
      "type": "string",
      "pattern": "^[a-f0-9]{64}$",
      "description": "SHA256 hex string of canonical intent sections"
    },
    "last_reviewed_at": {
      "type": "string",
      "format": "date-time",
      "description": "RFC3339 UTC timestamp of last review"
    },
    "staleness_days_threshold": {
      "type": "integer",
      "minimum": 1,
      "default": 21,
      "description": "Days before task is considered stale"
    },
    "closed_at": {
      "type": "string",
      "format": "date-time",
      "description": "RFC3339 UTC timestamp when task was closed"
    },
    "close_reason": {
      "type": "string",
      "enum": ["completed", "abandoned"],
      "description": "Reason for closing the task"
    },
    "superseded_by": {
      "type": "string",
      "description": "ID of task that supersedes this one"
    }
  },
  "additionalProperties": false
}
